
define(["j","app/evts"],function(c,t){var u=document.getElementById("page-title"),l=document.getElementById("page-info"),k=c("#cBtn"),g=null,h=null,d=null,m=c("#bg"),n=c("#page-input"),b=null,p=c("#content"),e=null,q=/^[a-zA-Z ]{1,20}$/,s=function(){if(null==g||null==h||g.key!=e.getStep().key){g=e.getStep();if("ProfileComplete"==g.key){e.submit();return}h=e.getPageData(g.key);d=h.prompts;u.innerHTML=h.title;l.innerHTML=h.info;m.removeClass();p.removeClass();p.addClass(h["class"]+"-bg-color");m.addClass(h["class"]+
"-bg");"Email"==g.key&&k.val("Resultados");for(var a=0;a<d.length;a++)d[a].answered=!1}for(a=0;a<d.length;a++)if("undefined"===typeof d[a].answered||!1==d[a].answered){b=d[a];break}r()},r=function(){if(null!=b&&(0==b.target||1==b.target&&e.getPG().isPair())){if(null!=b){var a="";if("size"==b.map)for(var f=e.getPG().getData()[b.target].gender+"html",c=0;c<b[f].length;c++)a+=b[f][c];else for(c=0;c<b.html.length;c++)a+=b.html[c];1==b.target&&(l.innerHTML="",pName=e.getPG().getData()[1].name,a=
a.replace("##PartnerPossessiveName##","s"==pName.slice(-1)?pName+"'":pName+"'s"),a=a.replace("##PartnerName##",pName));n.html(a)}}else e.completeStep(g.key),e.setStep(e.nextStep().key)},v=function(){if(null!=b){if("havePartner"==b.map){var a=c("input[type='radio'][name='radioInput']:checked");if("undefined"==typeof a||null==a)return!1;var f=c("label[for='"+a.attr("id")+"']").text();e.setAnswer(b.target,b.map,a.val(),f);if("True"==a.val())if(a=c("#textInput").val().trim(),"undefined"!=typeof a&&null!=
a&&0!=a.length&&q.test(a))e.setAnswer(1,"name",a);else return!1}else if("email"!=b.map)if("Text"==b.ui)if(a=c("#textInput").val().trim(),"undefined"!=typeof a&&null!=a&&0!=a.length&&q.test(a))e.setAnswer(b.target,b.map,a);else return!1;else if("size"==b.map){a=c("input[type='radio'][name='pantInput']:checked");f=c("input[type='radio'][name='shirtInput']:checked");if("undefined"===typeof a||null==a||0==a.length||"undefined"===typeof f||null==f||0==f.length)return!1;var d=c("label[for='"+a.attr("id")+
"']").text(),g=c("label[for='"+f.attr("id")+"']").text();e.setAnswer(b.target,"pant",a.val(),d);e.setAnswer(b.target,"shirt",f.val(),g)}else if("Radio"==b.ui){a=c("input[type='radio'][name='radioInput']:checked");if("undefined"===typeof a||null==a||0==a.length)return!1;f=c("label[for='"+a.attr("id")+"']").text();e.setAnswer(b.target,b.map,a.val(),f)}else if("CheckBox"==b.ui){a=c("input[type='checkbox'][name='checkInput']");f={};for(d=0;d<a.length;d++)f[a[d].value]=a[d].checked;e.setAnswer(b.target,
b.map,f)}return!0}return!1};return{initUI:function(a){e=a;s();t.subscribe("newStep",s);k.on("click",function(){a:{k.blur();if(null!=b){if(!v())break a;b.answered=!0}n.html("");b=null;for(var a=0;a<d.length;a++)if("undefined"===typeof d[a].answered||!1==d[a].answered){b=d[a];break}r()}})}}});
	