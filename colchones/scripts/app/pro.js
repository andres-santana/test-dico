
define(["j","app/pd","app/PG","app/evts"],function(g,h,p,q){var d=null,e=null,f=null,k=function(a){if(null===d)return-1;for(var b=0;b<d.length;b++)if(d[b].key==a)return b;return-1},l=function(){if(null===d)return-1;for(var a=0;a<d.length;a++)if(!d[a].complete)return a;return-1},m=function(){var a=l();if(-1!=a)return d[a]},n=function(){for(var a=e.getData(),b=[],c=0;c<a.length;c++)b.push({}),b[c].Name=a[c].name,b[c].Age=a[c].age,b[c].Gender=a[c].gender,b[c].Position=a[c].position,b[c].Height=a[c].height,
b[c].Weight=a[c].weight,b[c].Pant=a[c].pant,b[c].Shirt=a[c].shirt,b[c].Pain=a[c].pain,b[c].EmailAddress=a[c].email;g.ajax({type:"POST",url:"/colchones/resultado/",data:JSON.stringify({profiles:b}),contentType:"application/json",success:function(a){window.top.location.href="http://dico.com.mx/colchones?va="+a},error:function(a){alert("error - "+a)}})};return{init:function(){d=[{key:"Welcome",complete:!1},{key:"Partner",complete:!1},
{key:"Gender",complete:!1},{key:"Age",complete:!1},{key:"Position",complete:!1},{key:"Height",complete:!1},{key:"Weight",complete:!1},{key:"Sizes",complete:!1},{key:"Pain",complete:!1},{key:"Email",complete:!1},{key:"ProfileComplete",complete:!1}];e=p.getPG();f=m();setTimeout(function(){g("#menu, #content").fadeIn()},1E3)},nextStep:m,getStep:function(){return f},setStep:function(a){if(null!==d&&null!==h){var b=k(a),c=l();b>c||("ProfileComplete"==a?n():(f=d[b],q.publish("newStep",{})))}},completeStep:function(a){a=
k(a);d[a].complete=!0},setAnswer:function(a,b,c,d){e.setValue(a,b,c);"email"!=b&&"name"!=b&&"undefined"!=typeof d&&null!=d&&e.setValue(a,b+"Text",d)},setAnswers:function(a,b,c){"pain"==b&&e.setPain(a,c)},getPG:function(){return e},getPageData:function(a){return h[a]},getProgress:function(){for(var a=[],b=0;b<d.length;b++)d[b].completed&&a.push(d[b].key);return a},submit:n}});
